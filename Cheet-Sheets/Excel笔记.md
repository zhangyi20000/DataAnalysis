
[TOC]

## 学习资料

['戴戴大师兄的excel入门视频'](https://www.bilibili.com/video/BV1ZM4y1u7uF?spm_id_from=333.788.videopod.episodes&vd_source=765c0e638b781bb753c33e8d4841cbbb&p=2)

['视频的笔记'](https://yrzu9y4st8.feishu.cn/mindnotes/bmncnhnbFWnUNvUq6qTkq49IQ3c)

## 笔记

### 其他tips

- 拿到数据之后，先进行备份。
操作：右键->移动->移至最后+建立副本。
- 不要用excel中的日期格式存储日期。用**字符串**存储日期。
- 在下拉填充的时候检查一下数据范围是否改变

### 常用快捷键

- ctrl+shitf+L: 快速筛选

- fn+f4 选中函数内地址，会锁定。$

- alt+= ：快速求和

### 常用符号

- *：通配符，任意数量的字符（包括0个）

- ?：占位符，代表任意单个字符

- ~：用于转义 * 或 ?。如"A~*"：是为了匹配"A*"

- &：连接字符串；连接文本和单元格内容

- $:锁定行或列，防止在复制公式时改变引用的单元格地址。
  - 绝对引用：$A$1。公式复制到其他位置时，单元格不会变。
  - 混合引用：$A1。列 A 不变，但行号会变化
  - 混合引用：A$1。锁定行，不锁定列
  - 快捷键：F4

### 常用函数

- 求和函数
  - sum()函数
    - 可以多区域求和，不连续区域用英文逗号隔开

  - sumif()函数：单条件判断
    - 函数语法：SUMIF(应用条件的单元格范围, 条件, [求和范围])
    
    - sumifs()函数：多条件判断  
函数语法：SUMIFS(求和的单元格范围, 第一个条件范围, 应用于criteria_range1的条件, [criteria_range2, criteria2], ...)

- 条件函数if  
  - 语法：IF(逻辑表达式, value_if_true, value_if_false)

- subtotal()函数：
  - 对数据区域执行指定的聚合计算（如求和、平均值、计数等），并且能够忽略隐藏的行（在筛选的时候不会计算未被筛选的行）
  - SUBTOTAL(计算类型的编号, 区域1, [区域2], …)

- 日期函数：
  - year
  - month
  - day
  - DATE(year、month、day)  
    day：1 到 31 之间的整数。如果超出当月天数，则会自动进位到下个月

- vlookup()函数：
  - 语法：VLOOKUP(要查找的值, 查找的表格区域, 返回值所在列的索引, [range_lookup])
  - 只能右向查找：查找表格区域的第一列需要包含查找值
  - 只会返回查找到的第一个值。
  - 模糊查找：查找范围的第一列必须按**升序**排序。它会找到 小于或等于查找值的最大值，然后返回对应的结果。

- 模糊查找：

- INDEX+MATCH
  - 目的：让excel自动的根据表头和列名在原数据中自动进行聚合或函数计算。（灵活）来替代 vlookup
  - INDEX函数
    - 根据指定的行号和列号，返回数据区域中的对应值
    - 语法：INDEX(数据区域, 要查找的行号, [要查找的列号])
    - 如果行位置或列位置为0，则返回整行或整列
  - MATCH函数
    - 返回某个值在指定区域中的位置
    - 语法： MATCH(要查找的值, 查找范围, [match_type])
      - [match_type]：0：精确匹配；1（默认）：近似匹配，要求查找范围升序排序；-1：近似匹配，要求降序排序
  - 联合使用
    - 用法：index(数据区域,match找到行，match找到列)
    - 注意：在填充的时候要明白什么是不变的，什么是变的。在写的时候就锁定。
  - 布尔运算
    - =;<>;>;<;>=;<=;
    - AND(逻辑1, 逻辑2, ...);OR(逻辑1, 逻辑2, ...);NOT(逻辑)
    - 判断条件是否需要加双引号
      - 如果条件是数字或者单元格引用时，不需要在条件上加双引号。
      - 如果条件是表达式时，必须加双引号。
      - 如果结合 比较运算符 和单元格引用时，需要用 **&** 将两者连接起来。如：">="&E39

### 常用计算

- 某个月的和
- 日环比
- 月度和  
计算当个月第一天，当月的最后一天(下个月的一天-1)

### 常用功能

#### 数据透视表

- 双击透视后表头可以修改名称
- **新建字段**：分析->字段和项->计算字段
- **插入切片器**（相当于筛选的功能，但是切片器可以复制到其他的工作表中，同步变化）

#### 数据透视图

直观展示，单个图或者组合图

#### 视图-新建窗口

方便查看多个sheet
skill:win+左右键 可以分屏

### 迷你图

- 选中时间序列数据
- 插入-折线-迷你图单元格位置-显示：标记

### 进度条

- 开始 - 条件格式 -新建规则-数据条 -最大值和最小值的类型改为数字,值改为0,1

### 单元格格式

- 根据值范围改变颜色
  - 开始 -条件格式 - 新建规则- 只为包含一下内容的单元格设置格式 - 规则说明： 大于0 设置格式为字体颜色为绿色
  - 开始 -条件格式 - 新建规则- 只为包含一下内容的单元格设置格式 - 规则说明： 小于等于0 设置格式为字体颜色为红色
- 根据值添加上下箭头
  - 开始 -条件格式 - 新建规则- 基于各自值设置所有单元格的格式 - 格式样式： 图表集 - 选择图标以及对应的值范围
- 标注小于单元格范围平均值
  - 选中范围-条件格式 - 新建规则 - 使用公式确定要设置格式的单元格 - 设置公式(C13 < AVERGE(范围)) - 设置单元格格式 - 字体设置

## 周报搭建

1. 设计时间
   1. 日期填一个，第二个日期+1,之后拖拽填充。其余需要用到日期的地方直接基于填写的日期进行引用。
   2. 星期：直接在数据格式中修改。
2. 设置数据验证  
   位置：数据->数据验证->设置。验证条件：序列；来源：全部,类型1,类型2
3. 对于设置了数据验证时，在计算要进行嵌套判断。在进行下拉的时候，记得绝对引用和相对引用。
4. 在计算值时,可以使用index和match,实现全自动。
5. 视图 - 取消网格线
